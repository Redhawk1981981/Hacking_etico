# Informe de Pentesting: Talent Scouttech

## 1. Resumen Ejecutivo
El presente informe presenta de forma detallada las vulnerabilidades que han sido encontradas e identificadas en la web de la empresa Talent Scouttech. Tras las pruebas de penetración realizadas, se han encontrado algunas vulnerabilidades críticas que podría poner en riesgo y/o comprometer la integridad, confidencialidad y disponibilidad del sistema.

## 2. Alcance del Pentesting
Las pruebas de penetración se han realizado sobre la Aplicación web de gestión de jugadores propiedad de la empresa.

## 3. Metodología
La metodología usada ha sido la siguiente:
- Análisis de código fuente de la web
- Pruebas de inyección SQL
- Pruebas de Cross-Site Scripting (XSS)
- Evaluación de la gestión de sesiones
- Análisis de vulnerabilidades CSRF

## 4. Hallazgos y Análisis

### 4.1 Inyección SQL (CWE-89)
- **Severidad**: Alta (CVSS v3.1: 8.8)
- **Descripción**: Se han identificado varias vulnerabilidades de inyección SQL en diversas paginas de la web, como en en formulario de identificación, permitiendo la impersonación de usuarios y en el formulario de comentarios de jugadores, pudiendose añadir comentarios en nombre de otro usuario. 
- **Impacto**: El atacante podría ejecutar consultas SQL de modo que pudiera obtener acceso ilegítimo a la web, con unas credenciales que no le pertenecen, asi como escribir comentarios con la información de otro usuario.
- **Ejemplo de explotación**:
  ```
  'http://web.com/add_comment.php?id=1', '2', 'Comentario falso') --
  ```
- **Mitigación**: Implementar consultas preparadas.

### 4.2 Cross-Site Scripting (XSS) (CWE-79)
- **Severidad**: Media (CVSS v3.1: 6.1)
- **Descripción**: Se han encontrado vulnerabilidades XSS en las páginas de búsqueda y añadir jugador, asi como en la página de añadir comentarios a los jugadores.
- **Impacto**: Un atacante podría inyectar scripts maliciosos, robando sesiones de usuario o realizando acciones no autorizadas.
- **Ejemplo de explotación**:
  ```
  <script>alert('XSS')</script>
  ```
- **Mitigación**: Implementar escape de salida de datos.

### 4.3 Gestión Insegura de Sesiones (CWE-384)
- **Severidad**: Media (CVSS v3.1: 5.4)
- **Descripción**: Se ha descubierto, que, la gestión de sesiones de la web carecía de medidas de seguridad adecuadas.
- **Impacto**: Posible secuestro de sesiones y acceso no autorizado a cuentas de usuario.
- **Mitigación**: Implementar regeneración de ID de sesión, validación de sesiones y tiempo de expiración.

### 4.4 Cross-Site Request Forgery (CSRF) (CWE-352)
- **Severidad**: Media (CVSS v3.1: 6.5)
- **Descripción**: La aplicación es vulnerable a ataques CSRF, permitiendo la ejecución de acciones no autorizadas.
- **Impacto**: Un atacante podría forzar a usuarios autenticados a realizar acciones no intencionadas, como transferencias de fondos.
- **Ejemplo de explotación**:
  ```
  <img src="http://web.pagos/donate.php?amount=100&receiver=attacker" style="display:none;" />
  ```
- **Mitigación**: Implementar tokens anti-CSRF en todos los formularios y solicitudes POST.

## 5. Recomendaciones de Mitigación
Para mitigar todas estas vulnerabilidades, recomendamos llevar a cabo las siguientes acciones:
Se podrían implementar consultas preparadas en todas las interacciones con la base de datos, se deben utilizar funciones de escape de salida para prevenir ataques XSS, mejorar la gestión de sesiones con regeneración de ID y validaciones de seguridad. La implementación de tokens CSRF en todos los formularios y solicitudes que modifiquen datos, configurar encabezados de seguridad como Content Security Policy (CSP) y HTTP Strict Transport Security (HSTS).

## 6. Conclusión
La aplicación presenta vulnerabilidades significativas que requieren atención inmediata. La implementación de las medidas de mitigación que se han propuesto, mejorará notablemente la seguridad de la aplicación web